# <%= model %>を使った<%= target %>と選択された予測変数の関係の分析

目的変数である<%= target %>と選択された予測変数との関係を調べるために線形回帰を使った予測モデルが作られました。

<% if (max(VIF) > 10) { %>

# 注意点

{{multicollinearity}}

このモデルには多重共線性（複数の予測変数間に強い相関関係があること）の問題が見られます。VIFの値が10を超えている予測変数があると、個々の変数の効果を正確に評価することが難しくなります。

この問題を解決するためには、VIFの値が10を超えている予測変数の中から必要性が低いものを1つずつ除外し、再実行し、VIFの値が10を超える予測変数がなくなるまで繰り返してみてください。

<% } %>

# 分析結果

## 予測精度

{{summary_chart}}

**<%= target %>のばらつきの説明能力**

<% if (r_square > 0.8) { %>
  R2乗は<%= 100 * r_square %>% (<%= r_square %>)と非常に高く、これは選択された予測変数で<%= target %>のばらつきのほとんどを説明できることを示しています。
<% } else if (r_square > 0.6) { %>
  R2乗は<%= 100 * r_square %>% (<%= r_square %>)と高く、これは選択された予測変数で<%= target %>のばらつきをうまく説明できることを示しています。
<% } else if (r_square > 0.4) { %>
  R2乗は<%= 100 * r_square %>% (<%= r_square %>)と中程度ですが、選択された予測変数で<%= target %>のばらつきをそれなりに説明できることを示しています。
<% } else if (r_square > 0.2) { %>
  R2乗は<%= 100 * r_square %>% (<%= r_square %>)と低いですが、選択された予測変数で<%= target %>のばらつきのある程度の傾向は捉えているが、重要な予測変数が抜けている可能性があります。
<% } else { %>
  R2乗は<%= 100 * r_square %>% (<%= r_square %>)と非常に低いため、選択された予測変数では<%= target %>のばらつきはあまり説明できていません。
<% } %>

**モデルの有意性**

選択された予測変数による<%= target %>のばらつきの説明能力に関わらず、それらの予測変数と<%= target %>の関係は

<% if (p > 0.05) { %>
  P値は<%= 100 * p %>% (<%= p %>)で、有意水準5% (0.05) より高いため、統計的に有意とは言えません。
<% } else { %>
  P値は<%= 100 * p %>% (<%= p %>)で、有意水準5% (0.05) より低いため、統計的に有意だと言えます。
<% } %>

**予測精度**

RMSE（平均二乗誤差のルート）は1,110.3で、これはこの予測モデルを使って元データを予測したときの予測値と実際の値の間の平均的な誤差を示しています。


## 選択された予測変数と<%= target %>の関係の強さ

選択された予測変数と<%= target %>の関係の強さを相対的に表したのが以下のチャートです。

{{variable_importance}}

## それぞれの予測変数と<%= target %>の関係

それぞれの予測変数の値が変わると、<%= target %>の値がどのように変わるかを表したのが以下のチャートです。変数は<%= target %>との関係が最も強いものから弱い方への順番で並んでいます。

{{variable_effect}}

<% if (variable1 == numeric) { %>
他の変数の値が一定だとしても、<%= variable1 %>が1段階上がると、<%= target %>は約<%= value %>単位上がります。
<% } else if (variable1 == logical) { %>
他の変数の値が一定だとしても、<%= variable1 %>がTRUEの場合、FALSEに比べ<%= target %>は約<%= value %>単位の差があります。  
<% } else { %>
他の変数の値が一定だとしても、<%= variable1 %>は、ベースレベルである<%= base_level %>と比べて約<%= value %>の差があります。
<% } %>


## 変数ごとの係数と有意性

それぞれの予測変数の有意性、またそれらの値が1ポイント変わると<%= target %>の値がどれほど変わるのか（係数）を表したのが以下のチャートです。

{{coefficient}}

それぞれのエラーバーの真ん中の点は係数の値、上下の線はその95%信頼区間を表しています。<%= target %>との関係が有意で、かつその関係が正の予測変数は青、関係が負の予測変数は赤となっています。グレーで表されている予測変数は<%= target %>との関係が有意とは言えません。有意性の判断はP値または信頼区間によって行うことができます。どちらで判断しても同じ結果となります。

### P値

有意水準が5%の元では、P値が5%よりも大きい予測変数は<%= target %>との関係が統計的に有意だとは言えません。逆に、P値が5%よりも小さい予測変数は<%= target %>との関係が統計的に有意だと言えます。

_現在の有意水準（P値）は<%= 100 * base_line_p %>% (<%= base_line_p %>)に設定されていますが、これはアナリティクスの「設定」より変更可能です。_

### 信頼区間

係数の95%信頼区間は、「真の係数の値がこの範囲内にある可能性が95%ある」ということを意味します。そのため、95%信頼区間が0を含んでいる予測変数は、<%= target %>との関係が全くない可能性があるため、統計的に有意だと言えません。逆に、95%信頼区間が0を含んでいない予測変数は、<%= target %>との関係が全くない可能性はほぼないため、統計的に有意だと言えます。


それぞれの予測変数の係数はそのデータ型によって以下のように解釈できます。

**数値型の場合：**

他の変数の値が一定だとしても、<%= variable1 %>が1単位上がると、<%= target %>は約<%= value %>単位上がります。

**ロジカル型の場合：**

他の変数の値が一定だとしても、<%= variable1 %>がTRUEの場合、FALSEに比べ<%= target %>は約<%= value %>単位の差があります。  

**カテゴリー（文字列）型の場合：**

他の変数の値が一定だとしても、<%= variable1 %>は、ベースレベルである<%= base_level %>と比べて約<%= value %>の差があります。


### 注意点

* これらの係数の値は、あくまでもそれぞれの予測変数の値が1ポイント変わった場合の変化量であり、予測変数同士で単位が異なる場合にはそれらの係数の値を使って<%= target %>との関係の強さを比べることはできません。予測変数間の関係の強さを比べたい場合は、上記の「選択された予測変数と<%= target %>の関係の強さ」を参照ください。

上記のチャートの元となるデータが以下の表となります。

{{coefficient_table}}


# 次のステップ

* 変数選択の最適化：統計的に有意でない変数（P値が5%以上の変数）を除外して、モデルをシンプルにすることを検討してください。これにより、モデルの解釈がしやすくなり、過剰適合のリスクも減少します。
* グループ別分析：グループごとに別々のモデルを作成することで、それぞれのグループ内での<%= target %>の決定要因をより詳細に理解できるかもしれません。その場合は、「繰り返し」にグループとなる変数を選択し、実行し直すことができます。
* 非線形関係の検討：<%= target %>と非線形の関係を持つ予測変数はデータを加工することで、より正確にモデル化することができます。
* 外れ値の確認：予測精度に影響を与える可能性のある外れ値がないか確認し、必要に応じて対処することで、モデルの信頼性が向上する可能性があります。


# 補足情報

## トレーニングデータに対する予測

元のデータに対して、作成された予測モデルを使って予測した結果が以下の表となります。

{{data}}

## 実測値と予測値の関係

予測した結果、元の実測値と予測値にはズレがありますが、それらの関係を散布図を使って可視化したのが以下のチャートです。それぞれの点はそれぞれの行を表しています。

{{actual_predicted}}

## 予測値と残差の関係

予測した結果、予測値と残差（元の実測値と予測値のズレ）の関係を散布図を使って可視化したのが以下のチャートです。それぞれの点はそれぞれの行を表しています。

{{predicted_residual}}

## 残差の分布

残差（元の実測値と予測値のズレ）のばらつきをヒストグラムを使って可視化したのが以下のチャートです。

{{residual}}
