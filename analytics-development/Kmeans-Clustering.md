const template = `

# サマリ

現在のデータの1行を1観察対象として、以下の変数を元に「K-Means クラスタリング」の手法を使ってデータを<%= cluster_number %>つのクラスター（グループ）に分類しました。現在のクラスターの数は<%= cluster_number %>ですが、[「設定」](//analytics/settings)より変更可能です。

<% variables.forEach(variable => { %>
  - <%= variable.name %>
<% }); %>

それぞれのクラスターに分類されたデータ量と分類に使われた変数に対する平均的なスコア（標準化された値）は以下の表で確認できます。

{{summary}}

* Excluded Rows（除外された行） -  1つでも変数に欠損値（NA）がある行は事前にデータから除外されます。Excluded Rowsの割合が高い場合、利用する変数を見直すか、欠損値を補完してください。

# クラスターと変数の関係

<!-- AI_SUMMARY -->

## レーダーチャートによる可視化

分類に使われた変数に対する平均的なスコア（標準化された値）を元にそれぞれのクラスターの特徴を解釈することができます。

{{radar}}

それぞれの軸の値はそれぞれの変数の元の値を標準化したものです。平均値は0で、正の値は平均よりも高いことを意味し、負の値は平均よりも低いことを意味します。


## 箱ひげ図による可視化

クラスターごとに、それぞれの変数における値のばらつきを箱ひげ図を使って可視化したものが以下です。

{{boxplot}}

Y軸の値はそれぞれの変数の元の値を標準化したものです。平均値は0で、正の値は平均よりも高いことを意味し、負の値は平均よりも低いことを意味します。

## 散布図による可視化

クラスターと変数の関係、そして変数間の関係を散布図を使って可視化したものです。これは、「バイプロット」と呼ばれるチャートです。

{{biplot}}

元のデータは<%= variables.length %>個の変数によって表されますが、全てのデータのばらつきを２次元（X軸とY軸）空間で可視化することができません。そこで、できる限り元のデータの持つ情報量（ばらつき）を失わないように、元のデータのばらつきを仮想的に作られた2つの変数（X軸、Y軸）によって可視化しようとしたものがこのチャートです。X軸は元データのばらつきの<%= ratio_of_variance_of_p1_pct %>%を表し、Y軸は<%= ratio_of_variance_of_p2_pct %>%を表しています。

それぞれの変数は中心点（0, 0）から外側に向かって伸びるグレーの線によって表されています。線が同じ方向に向かっている変数は相関が強い変数同士だと言えます。

それぞれのクラスターは、どの線に近いかによってその特徴を解釈することができます。外に向かって伸びる線の先に近ければ、その変数のスコアが高いクラスターだと言えます。逆に、0を挟んで逆側にある場合は、その変数のスコアが低いクラスターだと言えます。

<% if (has_category) { %>

# カテゴリーとの関係

カテゴリーとして選択された'<%= category %>'列とクラスターの関係をバーチャートを使って可視化したものが以下です。

{{category_ratio}}

<% } %>

# 補足情報

## データ

クラスターの分類結果を元に、元のデータのそれぞれの行にクラスターのIDが割り振られています。

{{data}}
`;

module.exports = template;
