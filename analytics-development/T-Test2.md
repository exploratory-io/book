const template = `
# サマリ

今回の分析では、<%= explanatory %>による<%= target %>の平均の差が有意かどうかを調べました。

{{summary}}

<% if (p > baseline_p) { %>
結果として、P値は**<%= p_pct %>% (<%= p %>)**で、有意水準<%= baseline_p_pct %>% (<%= baseline_p %>) より大きいため、<%= explanatory %>による<%= target %>の平均の差は統計的に有意とは言えません。

  <% if (power < 0.5) { %>
ただ、検出力は<%= power_pct %>% (<%= power %>)と低く、もし実際に差があったとしても、見逃す確率（タイプ２エラー）が<%= type2_error_pct %>% (<%= type2_error %>)と非常に高いため注意が必要です。
  <% } else { %>
ただ、検出力は<%= power_pct %>% (<%= power %>)と低めであり、もし実際に差があったとしても、見逃す確率（タイプ２エラー）が<%= type2_error_pct %>% (<%= type2_error %>)もあるため注意が必要です。
  <% } %>
<% } %>

<% if (p <= baseline_p) { %>
結果として、P値は**<%= p_pct %>% (<%= p %>)**で、有意水準<%= baseline_p_pct %>% (<%= baseline_p %>) より低いため、<%= explanatory %>による<%= target %>の平均の差は統計的に有意だと言えます。

  <% if (effect_size < 0.2) { %>
効果量は<%= effect_size %>と低く、<%= explanatory %>による<%= target %>の平均の差は小さなものです。
  <% } else if (effect_size < 0.8) { %>
効果量は<%= effect_size %>なので、<%= explanatory %>による<%= target %>の平均の差は中程度です。
  <% } else { %>
効果量も<%= effect_size %>と大きく、<%= explanatory %>による<%= target %>の平均の差は大きいと言えます。
  <% } %>
<% } %>

{start_show_hide}
## 統計指標の説明

* t値
  * t値は2つの平均値の差が偶然によるものか、本当に異なるのかを示す統計量です。手元のデータの平均の差を標準誤差で割った値です。
  * 値の絶対値が大きいほど、平均値の差が偶然ではない可能性が高いことを示します。一般的には絶対値が2以上で意味がある差と考えられます。

* P値
  * P値は観測されたデータが帰無仮説（グループ間に差がない）と同等かそれ以上に極端である確率を示します。
  * 一般的に5%（0.05）未満であれば、統計的に有意であると判断されます。
  * 値は0から1の間で、P値が小さいほど統計的有意性が高いことを示します。

* 自由度
  * 自由度はt検定において、データが取りうる自由な変動の数を表します。一般に「全サンプル数 - グループ数」で計算されます。
  * 常に正の整数値を取り、値が大きいほど検定の精度が高まります。
  * 自由度が大きくなるにつれてt分布は正規分布に近づきます。

* 差
  * 差は比較する2つのグループの平均値の差を表します。
  * 差の値そのものは測定単位によって異なり、正の値は第一グループの平均が高いことを、負の値は第二グループの平均が高いことを示します。
  * 差の大きさだけでなく、信頼区間とP値を合わせて解釈することが重要です。

* 信頼区間下限
  * 信頼区間下限は、統計的に推定された平均値の差の下限を示します。
  * この値より低い差である確率は、設定した信頼水準（通常95%）の半分（2.5%）未満です。

* 信頼区間上限
  * 信頼区間上限は、統計的に推定された平均値の差の上限を示します。
  * この値より高い差である確率は、設定した信頼水準（通常95%）の半分（2.5%）未満です。
  * 信頼区間の幅が広いほど推定の精度が低く、狭いほど精度が高いことを示します。
  * 信頼区間に0が含まれない場合（下限がプラスか、上限がマイナス）、統計的に有意な差があると判断できます。

* ベースレベル
  * ベースレベルは比較の基準となるグループや条件を示します。
  * 差や効果量はこのベースレベルと比較した相対的な値として表されます。

* Cohen's D
  * Cohen's Dは効果の大きさを示す指標で、グループ間の差をデータのばらつき（標準偏差）で割った値です。
  * 値が0.2の場合は「小さい効果」、0.5は「中程度の効果」、0.8以上は「大きい効果」と解釈されます。

* 検出力
  * 検出力は実際に効果がある場合に、それを統計的に検出できる確率を表します。
  * 値は0から1の間で、一般的には0.8（80%）以上が望ましいとされています。
  * 検出力が低い場合、実際に存在する効果を見逃している可能性があることを示します。

* タイプ2エラー
  * タイプ2エラーは「実際には効果があるのに、ないと判断してしまう確率」です。
  * 値は0から1の間で、検出力 = 1 - タイプ2エラーの関係があります。
  * 一般的には0.2（20%）以下が望ましいとされています。

* 行数
  * 行数は分析に使用したデータの総数（サンプルサイズ）を示します。
  * サンプルサイズが大きいほど、統計的検定の検出力が高まり、結果の信頼性が向上します。
  * 検定の種類や効果量によって、必要なサンプルサイズは異なります。
{end_show_hide}

# 有意性

有意性については、P値または信頼区間のどちらかによって判断できます。どちらも同じ結果となります。

## P値

この検定における帰無仮説は「<%= group_a %>と<%= group_b %>の<%= target %>の平均に差がない」というものです。

<% if (p > baseline_p) { %>
検定の結果、P値が<%= p_pct %>% (<%= p %>)となりました。これは、もし帰無仮説が正しいのであれば、今回のデータのように<%= mean_diff %>以上の差がたまたま起きる確率が約<%= p_pct %>%であるということです。有意水準が<%= baseline_p_pct %>% (<%= baseline_p %>) の場合、この確率は十分に高いので、帰無仮説を棄却できません。つまり、<%= explanatory %>による<%= target %>の差は統計的に有意であると言えません。
<% } %>

<% if (p <= baseline_p) { %>
検定の結果、P値が<%= p_pct %>% (<%= p %>)となりました。これは、もし帰無仮説が正しいのであれば、今回のデータのように<%= mean_diff %>以上の差がたまたま起きる確率は約<%= p_pct %>%>しかないということです。有意水準が<%= baseline_p_pct %>% (<%= baseline_p %>) の場合、この確率は十分に低いので、帰無仮説を棄却できます。つまり、<%= explanatory %>による<%= target %>の差は統計的に有意であると言えます。
<% } %>

{{probability_dist}}

現在の有意水準（P値）は<%= baseline_p_pct %>% (<%= baseline_p %>)に設定されていますが、これはアナリティクスの[「設定」](//analytics/settings)より変更可能です。

## 有意性 - 信頼区間

<%= explanatory %>により<%= target %>の平均の差は約<%= mean_diff %>ですが、その95%信頼区間は<%= lower_end %>から<%= higher_end %>となっています。これは「<%= group_a %>と<%= group_b %>の<%= target %>の平均の差がこの範囲内にある可能性が95%ある」ということを意味します。

<% if (p > baseline_p) { %>
この区間に0（差がない）が含まれているため、<%= explanatory %>による<%= target %>の平均の差は有意であると言えません。
<% } %>

<% if (p <= baseline_p) { %>
この区間に0（差がない）が含まれていないため、<%= explanatory %>による<%= target %>の平均の差は有意であると言えます。
<% } %>

{{confidence_interval}}

# 効果量

統計的有意性（P値）はサンプルサイズが大きいと、小さな差でも「有意」と判定されることがあるために、効果量を元にして実際の効果の大きさを評価することができます。
この検定では効果量であるCohen's Dが<%= effect_size %>と示されています。これは、<%= explanatory %>による<%= target %>の平均値の違いの大きさを標準化したものです。

<% if (effect_size < 0.2) { %>
効果量は<%= effect_size %>と低く、<%= explanatory %>による<%= target %>の平均の差は小さなものです。
<% } else if (effect_size < 0.8) { %>
効果量は<%= effect_size %>なので、<%= explanatory %>による<%= target %>の平均の差は中程度です。
<% } else { %>
効果量も<%= effect_size %>と大きく、<%= explanatory %>による<%= target %>の平均の差は大きいと言えます。
<% } %>

<% if (p > baseline_p) { %>
ただ、効果量は検定結果において有意と判断した場合に注意する必要がありますが、今回は有意でないため、特に注意する必要はありません。
<% } %>

<% if (p <= baseline_p) { %>
今回の検定結果は有意と判断できますが、効果量が小さいため注意が必要です。
<% } %>

以下のテーブルは、t検定における効果量（Cohen's D）の解釈の目安を示しています。

| 効果量の値 | 効果量の大きさ |
|------------|------------|
| 0.2 | 小さい効果 |
| 0.5 | 中くらいの効果 |
| 0.8 | 大きい効果 |

# 検出力

<% if (power < 0.5) { %>
検出力は<%= power_pct %>% (<%= power %>)と低い値になっています。これは、もし実際に<%= explanatory %>によって<%= target %>の平均に差があったとしても、それを正しく検出できる確率が約<%= power_pct %>%しかないということです。言い換えると、**本当は差があるのに「差がない」と誤って結論づけてしまう確率（タイプ２エラー）が<%= type2_error_pct %>% (<%= type2_error %>)**もあるということなので、有意なのかどうかの判断が困難となります。
<% } else if (power < 0.8) { %>
検出力は<%= power_pct %>% (<%= power %>)とやや低めになっています。これは、もし実際に<%= explanatory %>によって<%= target %>の平均に差があったとしても、それを正しく検出できる確率が約<%= power_pct %>%しかないということです。言い換えると、**本当は差があるのに「差がない」と誤って結論づけてしまう確率（タイプ２エラー）が<%= type2_error_pct %>% (<%= type2_error %>)**もあるということなので、慎重な判断が必要です。
<% } else { %>
<!-- Power is sufficient, no need to mention -->
<% } %>

# 補足情報

## 統計量

それぞれのグループごとの統計値は以下の通りです。

{start_lazy_show_hide}
### チャート
{{statistics}}
{end_lazy_show_hide}

## データの分布

<%= explanatory %>による<%= target %>の分布の違いを密度曲線を使って可視化したものが以下となります。

{start_lazy_show_hide}
### チャート
{{distribution}}
{end_lazy_show_hide}

## 平均値の信頼区間

それぞれのグループごとの平均の信頼区間をエラーバーを使って可視化したものが以下となります。

{start_lazy_show_hide}
### チャート
{{mean}}
{end_lazy_show_hide}

# 次のステップ

* 今回は<%= target %>に対する<%= explanatory %>という1つの変数が与える影響を分析しました。しかし、他の変数も<%= target %>に影響している可能性があります。そのため、「線形回帰」などを使った多変量分析を使い、複数の要因を同時に考慮した分析をすることができます。
* 今回の検定は全体に対して行われましたが、グループごとに分けて実施することも可能です。その場合は、「繰り返し」にグループとなる変数を選択し、実行し直すことができます。

`;

module.exports = template;