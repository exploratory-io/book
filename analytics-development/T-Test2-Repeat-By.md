const template = `
# サマリ

<%= explanatory %>による<%= target %>の平均の差が有意かどうかを<%= repeat_by %>ごとに調べました。

<% if (groups.some(group => group.p <= baseline_p)) { %>
以下のグループにおいては、P値が有意水準<%= baseline_p_pct %>% (<%= baseline_p %>) より低いため、統計的に有意だと言えます。
  <% groups.forEach(group => { %>
    <% if (group.p <= baseline_p) { %>
* <%= group.name %>
    <% } %>
  <% }); %>
<% } %>
<% if (groups.some(group => group.p > baseline_p)) { %>
以下のグループにおいては、P値が有意水準<%= baseline_p_pct %>% (<%= baseline_p %>) より高いため、統計的に有意とは言えません。
  <% groups.forEach(group => { %>
    <% if (group.p > baseline_p) { %>
* <%= group.name %>
    <% } %>
  <% }); %>
<% } %>

それぞれのグループの詳細については以下のとおりです。

{{summary}}

{start_show_hide}
## 統計指標の説明

* t値
  * t値は2つの平均値の差が偶然によるものか、本当に異なるのかを示す統計量です。手元のデータの平均の差を標準誤差で割った値です。
  * 値の絶対値が大きいほど、平均値の差が偶然ではない可能性が高いことを示します。一般的には絶対値が2以上で意味がある差と考えられます。

* P値
  * P値は観測されたデータが帰無仮説（グループ間に差がない）と同等かそれ以上に極端である確率を示します。
  * 一般的に5%（0.05）未満であれば、統計的に有意であると判断されます。
  * 値は0から1の間で、P値が小さいほど統計的有意性が高いことを示します。

* 自由度
  * 自由度はt検定において、データが取りうる自由な変動の数を表します。一般に「全サンプル数 - グループ数」で計算されます。
  * 常に正の整数値を取り、値が大きいほど検定の精度が高まります。
  * 自由度が大きくなるにつれてt分布は正規分布に近づきます。

* 差
  * 差は比較する2つのグループの平均値の差を表します。
  * 差の値そのものは測定単位によって異なり、正の値は第一グループの平均が高いことを、負の値は第二グループの平均が高いことを示します。
  * 差の大きさだけでなく、信頼区間とP値を合わせて解釈することが重要です。

* 信頼区間下限
  * 信頼区間下限は、統計的に推定された平均値の差の下限を示します。
  * この値より低い差である確率は、設定した信頼水準（通常95%）の半分（2.5%）未満です。

* 信頼区間上限
  * 信頼区間上限は、統計的に推定された平均値の差の上限を示します。
  * この値より高い差である確率は、設定した信頼水準（通常95%）の半分（2.5%）未満です。
  * 信頼区間の幅が広いほど推定の精度が低く、狭いほど精度が高いことを示します。
  * 信頼区間に0が含まれない場合（下限がプラスか、上限がマイナス）、統計的に有意な差があると判断できます。

* ベースレベル
  * ベースレベルは比較の基準となるグループや条件を示します。
  * 差や効果量はこのベースレベルと比較した相対的な値として表されます。

* Cohen's D
  * Cohen's Dは効果の大きさを示す指標で、グループ間の差をデータのばらつき（標準偏差）で割った値です。
  * 値が0.2の場合は「小さい効果」、0.5は「中程度の効果」、0.8以上は「大きい効果」と解釈されます。

* 検出力
  * 検出力は実際に効果がある場合に、それを統計的に検出できる確率を表します。
  * 値は0から1の間で、一般的には0.8（80%）以上が望ましいとされています。
  * 検出力が低い場合、実際に存在する効果を見逃している可能性があることを示します。

* タイプ2エラー
  * タイプ2エラーは「実際には効果があるのに、ないと判断してしまう確率」です。
  * 値は0から1の間で、検出力 = 1 - タイプ2エラーの関係があります。
  * 一般的には0.2（20%）以下が望ましいとされています。

* 行数
  * 行数は分析に使用したデータの総数（サンプルサイズ）を示します。
  * サンプルサイズが大きいほど、統計的検定の検出力が高まり、結果の信頼性が向上します。
  * 検定の種類や効果量によって、必要なサンプルサイズは異なります。

{end_show_hide}

# 有意性

有意性については、P値または信頼区間のどちらかによって判断できます。どちらも同じ結果となります。

## P値

この検定における帰無仮説は「<%= group_a %>と<%= group_b %>の<%= target %>の平均に差がない」というものです。

もし帰無仮説が正しいのであれば、今回のデータに見られる差かそれ以上の差がたまたま起きる確率がP値です。もし有意水準である<%= baseline_p_pct %>% (<%= baseline_p %>）より大きければ、帰無仮説を棄却できないため、統計的に有意だとは言えません。逆に、<%= baseline_p_pct %>% (<%= baseline_p %>）以下であれば、帰無仮説を棄却できるため、統計的に有意だと言えます。

{{probability_dist}}

現在の有意水準（P値）は<%= baseline_p_pct %>% (<%= baseline_p %>)に設定されていますが、これはアナリティクスの[「設定」](//analytics/settings)より変更可能です。

## 信頼区間

<%= explanatory %>による<%= target %>の平均の差の95%信頼区間を表したのが以下のチャートです。これは「<%= group_a %>と<%= group_b %>の<%= target %>の平均の差がこの範囲内にある可能性が95%ある」ということを意味し、この区間に0（差がない）が含まれていれば、この差は統計的に有意であるとは言えません。逆に、この区間に0（差がない）が含まれていなければ統計的に有意だと言えます。

{{confidence_interval}}

# 効果量

この検定では効果量であるCohen's Dが計算されています。これは、<%= explanatory %>による<%= target %>の平均値の違いの大きさを標準化したものです。

以下のテーブルは、t検定における効果量（Cohen's D）の解釈の目安を示しています。

| 効果量の値 | 効果量の大きさ |
|------------|----------------|
| D < 0.2 | 非常に小さい効果 |
| 0.2 ≤ D < 0.5 | 小さい効果 |
| 0.5 ≤ D < 0.8 | 中くらいの効果 |
| 0.8 ≤ D | 大きい効果 |

ただ、効果量は検定結果において有意と判断した場合に注意する必要があります。有意でなければ、特に注意する必要はありません。

# 検出力

検出力は、実際に<%= explanatory %>によって<%= target %>の平均に差があった場合に、それを正しく検出できる確率のことです。この検出力の逆がタイプ２エラーで、これは「本当は差があるのに差がないと誤って結論づけてしまう確率のことです。

検出力、およびタイプ２エラーは有意でないと判断した場合に注意する必要があります。一般的に検出力は80% (0.8) 以上あるのが望ましいとされています。それよりも低い場合には注意が必要です。

# 次のステップ

* 今回は<%= target %>に対する<%= explanatory %>という1つの変数が与える影響を分析しました。しかし、他の変数も<%= target %>に影響している可能性があります。そのため、「線形回帰」などを使った多変量分析を使い、複数の要因を同時に考慮した分析をすることができます。


# 補足情報

## 統計量

それぞれのグループごとの統計値は以下の通りです。

{start_lazy_show_hide}
### チャート
{{statistics}}
{end_lazy_show_hide}

## データの分布

<%= explanatory %>による<%= target %>の分布の違いを密度曲線を使って可視化したものが以下となります。

{start_lazy_show_hide}
### チャート
{{distribution}}
{end_lazy_show_hide}

## 平均値の信頼区間

それぞれのグループごとの<%= target %>の平均の信頼区間をエラーバーを使って可視化したものが以下となります。

{start_lazy_show_hide}
### チャート
{{mean}}
{end_lazy_show_hide}

`;

module.exports = template;