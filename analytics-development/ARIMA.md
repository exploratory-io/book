目的変数である<%= target %>を時系列予測するためにARIMA/SARIMAを使った予測モデルが作られました。

# 分析結果

## モデルの概要と予測精度

{{summary}}

{start_show_hide}
## モデルの指標の詳細
* RMSE
 * RMSEは平均二乗誤差の平方根を表し、予測値と実測値の誤差の大きさを測定します。
 * 目的変数と同じ単位で表されるため解釈しやすく、値が小さいほど予測精度が高いことを意味します。
 * 0以上の値を取り、完璧な予測であれば0になります。

* MAE
 * MAE（Mean Absolute Error：平均絶対誤差）は予測値と実測値の絶対誤差の平均を表します。
 * 目的変数と同じ単位で表され、値が小さいほど予測精度が高いことを示します。
 * RMSEと比べて外れ値の影響を受けにくい特性があります。

* MAPE (比率)
 * MAPE（Mean Absolute Percentage Error：平均絶対パーセント誤差）は予測の相対的な誤差をパーセンテージで表します。
 * 値が小さいほど予測精度が高く、一般的に10%未満であれば良好な予測と考えられます。
 * 実測値が0または非常に小さい場合、値が極端に大きくなる可能性があるため注意が必要です。

* R2乗
 * R2乗（決定係数）はモデルの説明力を示し、データの変動のうちモデルで説明できる割合を表します。
 * 値は通常0から1の間で、1に近いほどモデルの適合度が高いことを示します。
 * 時系列モデルでは、傾向があるデータで人為的に高くなることがあるため、解釈に注意が必要です。

* AIC
 * AIC（赤池情報量基準）はモデルの複雑さと適合度のバランスを評価する指標です。
 * 値が小さいほど優れたモデルとされ、過学習を防ぎながら最適なモデルを選択するのに役立ちます。
 * 異なるARIMA/SARIMAモデルを比較する際に特に有用です。

* BIC
 * BIC（ベイズ情報量基準）はAICと同様にモデル選択のための指標ですが、パラメータ数によるペナルティがより厳しいです。
 * AICよりも単純なモデルを選ぶ傾向があり、値が小さいほど良いモデルと判断されます。
 * 大きなサンプルサイズでの分析や、真のモデルが比較的単純だと考えられる場合に有用です。

* AICc
 * AICc（修正AIC）は小サンプルサイズでの偏りを修正したAICの変種です。
 * サンプルサイズが小さい場合でも信頼性の高いモデル選択が可能です。
 * サンプルサイズが大きくなるにつれてAICに近づきます。

* p, d, q
 * ARIMAモデルのパラメータで、p（自己回帰項の次数）、d（差分の次数）、q（移動平均項の次数）を表します。
 * pは過去の値がどれだけ現在の値に影響するか、qは過去の予測誤差がどれだけ影響するかを示します。
 * dはデータを定常化するために必要な差分の回数を示します。

* P, D, Q
 * SARIMAモデルの季節成分のパラメータで、P（季節自己回帰項の次数）、D（季節差分の次数）、Q（季節移動平均項の次数）を表します。
 * これらはpとq、dと同様の意味を持ちますが、季節周期ごとの関係を捉えます。

* 周期
 * 季節成分の周期を表し、例えば月次データなら12、四半期データなら4、週次データなら7などの値を取ります。
 * SARIMAモデルで季節性を考慮する際に重要なパラメータです。

* リュング・ボックス統計量
 * モデルの残差（予測誤差）に自己相関がないかをテストする統計量です。
 * 値が大きいほど、残差に自己相関が残っている可能性が高いことを示します。

* リュング・ボックス検定のP値
 * リュング・ボックス統計量に基づくP値で、通常0.05以上であれば残差に有意な自己相関がないと判断されます。
 * P値が小さい場合、モデルが時系列の構造を十分に捉えきれていない可能性があります。

* 行の数
 * 分析に使用したデータの総数（サンプルサイズ）を示します。
 * 時系列モデルでは、十分なデータ量があることが精度の高い予測には重要です。
{end_show_hide}

# 主要な統計指標

* RMSE
 * RMSE（Root Mean Square Error：平均二乗誤差の平方根）は予測値と実測値の誤差の大きさを測定します。
 * 目的変数と同じ単位で表されるため解釈しやすく、値が小さいほど予測精度が高いことを意味します。
 * 0以上の値を取り、完璧な予測であれば0になります。
 * 外れ値に対して敏感な指標です。

* MAE
 * MAE（Mean Absolute Error：平均絶対誤差）は予測値と実測値の絶対誤差の平均を表します。
 * 目的変数と同じ単位で表され、値が小さいほど予測精度が高いことを示します。
 * RMSEと比べて外れ値の影響を受けにくい特性があります。

* MAPE (比率)
 * MAPE（Mean Absolute Percentage Error：平均絶対パーセント誤差）は予測の相対的な誤差をパーセンテージで表します。
 * 値が小さいほど予測精度が高く、一般的に10%未満であれば良好な予測と考えられます。
 * 実測値が0または非常に小さい場合、値が極端に大きくなる可能性があるため注意が必要です。

* R2乗
 * R2乗（決定係数）はモデルの説明力を示し、データの変動のうちモデルで説明できる割合を表します。
 * 値は通常0から1の間で、1に近いほどモデルの適合度が高いことを示します。
 * 時系列モデルでは、傾向があるデータで人為的に高くなることがあるため、解釈に注意が必要です。

**モデルの適合度**

<% if (r_square > 0.8) { %>
 R2乗は<%= 100 * r_square %>% (<%= r_square %>)と非常に高く、モデルはデータの変動のほとんどを説明できています。
<% } else if (r_square > 0.6) { %>
 R2乗は<%= 100 * r_square %>% (<%= r_square %>)と高く、モデルはデータの変動を十分に説明できています。
<% } else if (r_square > 0.4) { %>
 R2乗は<%= 100 * r_square %>% (<%= r_square %>)と中程度で、モデルはデータの変動をある程度説明できています。
<% } else { %>
 R2乗は<%= 100 * r_square %>% (<%= r_square %>)と低め、モデルではデータの変動を十分に説明できていない可能性があります。
<% } %>

**予測誤差**

RMSE（平均二乗誤差の平方根）は<%= rmse %>、MAE（平均絶対誤差）は<%= mae %>で、これらはモデルの予測誤差をデータと同じ単位で表しています。MAPE（平均絶対パーセント誤差）は<%= mape * 100 %>%で、これは予測値が実際の値から平均して何パーセント離れているかを示しています。

<% if (mape < 0.1) { %>
 MAPEが10%未満であり、モデルの予測精度は高いと言えます。
<% } else if (mape < 0.2) { %>
 MAPEが10〜20%であり、モデルの予測精度は許容範囲内です。
<% } else { %>
 MAPEが20%を超えており、予測の改善の余地があります。
<% } %>

**モデルの診断**

<% if (ljung_box_p > 0.05) { %>
 リュング・ボックス検定のP値は<%= ljung_box_p %>で0.05を上回っており、モデルの残差に有意な自己相関は見られません。これはモデルが時系列の構造を適切に捉えていることを示唆しています。
<% } else { %>
 リュング・ボックス検定のP値は<%= ljung_box_p %>で0.05を下回っており、モデルの残差にはまだ自己相関が残っている可能性があります。モデルのパラメータの調整や、別のモデル構造の検討が必要かもしれません。
<% } %>

**モデル構造**

選択されたモデルは ARIMA(<%= p %>,<%= d %>,<%= q %>)
<% if (P !== undefined && D !== undefined && Q !== undefined && s !== undefined) { %>
 ×季節成分(<%= P %>,<%= D %>,<%= Q %>)<sub><%= s %></sub>
<% } %>
で、これは

<% if (p > 0) { %>
 * <%= p %>次の自己回帰項（過去<%= p %>期間の値が現在の値に影響）
<% } %>
<% if (d > 0) { %>
 * <%= d %>回の差分（トレンドの除去）
<% } %>
<% if (q > 0) { %>
 * <%= q %>次の移動平均項（過去<%= q %>期間の予測誤差が現在の値に影響）
<% } %>
<% if (P > 0) { %>
 * <%= P %>次の季節自己回帰項（<%= s %>期前の値が現在の値に影響）
<% } %>
<% if (D > 0) { %>
 * <%= D %>回の季節差分（季節的なパターンの除去）
<% } %>
<% if (Q > 0) { %>
 * <%= Q %>次の季節移動平均項（<%= s %>期前の予測誤差が現在の値に影響）
<% } %>

を含んでいることを意味します。

## 予測結果

モデルを使用した時系列データの予測結果を以下のグラフに示します。

{{prediction}}

## 時系列データの季節性

データに含まれる季節的なパターンを以下のグラフに示します。これは、一定の周期で繰り返される変動を表しています。

{{seasonality}}

## 時系列データのトレンド

データの長期的な傾向（トレンド）を以下のグラフに示します。

{{trend}}

## 時系列データの定常性

時系列データの定常性を評価した結果を以下に示します。定常なデータは平均と分散が時間によって変化しないという特性を持ちます。

{{stationarity}}

## 自己相関

時系列データの自己相関関数（ACF）を以下のグラフに示します。これは、現在の値と過去の値との相関関係を表します。

{{autocorrelation}}

## 偏自己相関

時系列データの偏自己相関関数（PACF）を以下のグラフに示します。これは、中間の値の影響を除いた、純粋な時間間隔ごとの相関関係を表します。

{{partial_autocorrelation}}

## 残差分析

モデルの残差（予測誤差）の分布を以下のグラフに示します。良いモデルでは、残差はランダムで、平均0、一定の分散を持つ正規分布に従うことが期待されます。

{{residuals}}

## 残差の自己相関

モデルの残差の自己相関関数（ACF）を以下のグラフに示します。残差に有意な自己相関がないことが望ましいです。

{{residual_autocorrelation}}

## 残差の偏自己相関

モデルの残差の偏自己相関関数（PACF）を以下のグラフに示します。残差に有意な偏自己相関がないことが望ましいです。

{{residual_partial_autocorrelation}}

# 次のステップ

* モデル比較：異なるパラメータ設定のARIMA/SARIMAモデルや、指数平滑法などの他の時系列モデルとの比較を行うことで、より適切なモデルを見つけられる可能性があります。
* 外部変数の検討：時系列データに影響を与える可能性のある外部要因（季節、休日、イベントなど）を考慮することで、予測精度が向上するかもしれません。
* 予測範囲の検討：長期予測と短期予測では精度が異なることが多いため、予測の目的に応じた適切な予測範囲を検討してください。
* 残差分析の詳細検討：残差に何らかのパターンが見られる場合、モデルが捉えきれていない構造がある可能性があります。異なるモデル構造を試してみることを検討してください。
* 頑健性のチェック：モデルが新しいデータに対しても安定して良い予測を提供するか、交差検証などの手法でチェックすることが推奨されます。

# 補足情報

## データの詳細

分析に使用した時系列データの詳細が以下の表となります。

{{data}}

